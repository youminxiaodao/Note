## Daemon线程

所谓守护线程(Daemon线程)就是运行在程序后台的线程，通常守护线程是由JVM创建的，用于辅助用户线程或者JVM工作，比较典型的如GC线程。用户创建的线程也可以设置为Daemon线程(通常需要谨慎设置)，程序的主线程(main线程)不是守护线程。Daemon线程在Java里面的定义是。如果虚拟机中只有Daemon线程运行，则虚拟机退出.

(1)虚拟机中可能同时有多个线程运行，只有当所有的非守护线程(通常都是用户线程)都结束的时候，虚拟机的线程才回结束，不管当前运行的线程是不是main线程.

(2)main线程运行结束，如果此时运行的其它线程全部是Daemon线程，JVM会使这些线程停止，同时退出。但是如果此时正在运行的其它线程有非守护线程，那么必须等所有的非守护线程结束，JVM才会退出.



## kill -9 pid的隐患

(1)缓存中的数据尚未持久化到磁盘中，导致数据丢失

(2)正在进行文件的写(write)操作，没有更新完成，突然退出，导致文件损坏.

(3)线程的消息队列中尚有接收到的请求消息还没来得及处理，导致请求消息丢失.

(4)数据库操作已经完成，例如账户余额更新，准备返回应答消息给客户端时，消息尚在通信线程的发送队列中派对等待发送，进程强制退出时，导致应答消息没有返回给客户端，客户端发起超时重试，会带来重复更新问题.

(5)句柄资源没有及时释放等其它问题.

